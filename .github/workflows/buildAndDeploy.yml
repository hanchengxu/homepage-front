name: Build and Deploy HomePage
# on:
#  push:
#   branches:
#     - master
#   paths-ignore:
#     - '.github/**'
#     - 'README.md'
#  pull_request:
#   branches:
#     - master
#   paths-ignore:
#     - '.github/**'
#     - 'README.md'
on:
  workflow_dispatch:
# on:
#   watch:
#     types: started
jobs:
 build-and-deploy:
  runs-on: ubuntu-latest
  steps:
  - name: Checkout
    uses: actions/checkout@master # å°†ä»£ç æ‹·è´åˆ°è™šæœºä¸­
    with:
     persist-credentials: false
  - name: Install and Build âš™ï¸
    run: |
     npm install
     npm run-script build
  - name: Deploy github Page ğŸš€
    uses: JamesIves/github-pages-deploy-action@releases/v3
    with:
     ACCESS_TOKEN: ${{ secrets.ACCESS_TOKEN }} # ä½¿ç”¨åˆšæ–°å»ºçš„secret
     BRANCH: gh-pages # å­˜æ”¾äº§ç‰©çš„åˆ†æ”¯åç§°
     FOLDER: dist # å­˜æ”¾buildåäº§ç‰©çš„ç›®å½•
  - name: show my IP
    run: |
     curl ifconfig.me
  - name: Deploy to Server
    uses: easingthemes/ssh-deploy@main
    env:
        SSH_PRIVATE_KEY: ${{ secrets.SERVER_SSH_KEY }}
        ARGS: "-rltgoDzvO --delete"
        SOURCE: "dist/"
        REMOTE_HOST: ${{ secrets.REMOTE_HOST }}
        REMOTE_USER: ${{ secrets.REMOTE_USER }}
        TARGET: ${{ secrets.REMOTE_TARGET }}
        EXCLUDE: "/node_modules/"
